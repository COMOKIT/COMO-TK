# COMOKIT-HPC - Post-Processing
ToolKit to aggregate extract CSV and post-process data to have useful informations.

# How to use :

## Aggregating output

Assuming your directory tree is composed of different subfolders, each representing a combination of parameters with multiple CSV file for each simulation performed for that given combination, it is possible to aggregate the data for one combination of parameters into one CSV, getting the mean, median, minimum, maximum, 5th and 95th percentiles, 25th and 975th permilles of the simulations. The commandline, if R is installed and correctly set in the PATH variable, is: 

```
$ Rscript aggregate.R input_folder output_folder nb_step
usage: aggregate.R input_folder output_folder nb_step

```
with (in that exact order): 
* input_folder the parent folder of the data generated by the model
* output_folder the target folder that will contain the resulting CSV files
* nb_step the maximum number of steps for all simulations

**Remarks**
The number of simulations is depending on the number of files named \*_building.csv . The CSV files generated by GAMA must have the followin columns, in that exact order, for age categories: 
* cumulative incidence, 
* number of individuals needing hospitalisations, 
* number of individuals needing ICU care, 
* number of susceptible individuals, 
* number of latent individuals, 
* number of asymptomatic individuals, 
* number of presymptomatic individuals, 
* number of symptomatic individuals, 
* number of recovered individuals, 
* number of dead individuals,
with each row representing the given number for a step of a simulation.

Age categories are expected to be splitted in 5-year gap categories, starting from 0-4, 5-9, up to 95 and over. 

For building, generated files are expected to contain one column per type of building, and one row represents the cumulative number of infections that happened in that type of building for a step of a simulation. 

Building types are expected to be the following:
"","school","shop","place_of_worship","meeting","restaurant","coffee","supermarket","playground","supplypoint","market","industry","hotel","karaoke", 
with "" being buildings without any type. 

**Example**
```
$ Rscript aggregate.R ./Documents/batch_output ./Documents/batch_aggregated 5000
```

# Build with
- R (3.6.3)

## Authors

* **Damien Philippon** - *Epidemiologist developer* - [DAM-Philippon](https://github.com/DAM-Philippon)

See also the list of [contributors](https://github.com/orgs/COMOKIT/people) who participated in this project.